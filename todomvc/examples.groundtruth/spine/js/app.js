/** (github.com/dynamic-deadfunction-detector)
* Instrumentation log function used by the instrumenter
* note that the data object is already stringified.
*/
var logHistory = [];
function instrumentation_log(data) {
    
                function exists(e) { return e.file == jData.file && e.range[0] == jData.range[0] && e.range[1] == jData.range[1]; }
                var jData = JSON.parse(data);
                if (logHistory.some(exists)){ return; }
                logHistory.push(jData);
    fetch("http://127.0.0.1:8004/alivefunction", {
                method: "POST",
                headers: { "Accept": "application/json", "Content-Type": "application/json" },
                body: data
            }).then((response) => { });
}


// Generated by CoffeeScript 1.10.0
(function() {instrumentation_log('{"type":"FunctionExpression","bodyRange":[48,4361],"range":[37,4361],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":18,"label":"spine"}');
  var TodoApp,
    bind = function(fn, me){instrumentation_log('{"type":"FunctionExpression","bodyRange":[92,149],"range":[76,149],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":1,"label":"spine"}'); return function(){instrumentation_log('{"type":"FunctionExpression","bodyRange":[111,146],"range":[101,146],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":0,"label":"spine"}'); return fn.apply(me, arguments); }; },
    extend = function(child, parent) {instrumentation_log('{"type":"FunctionExpression","bodyRange":[188,437],"range":[164,437],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":3,"label":"spine"}'); for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() {instrumentation_log('{"type":"FunctionDeclaration","bodyRange":[291,320],"range":[275,320],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":2,"label":"spine"}'); this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  TodoApp = (function(superClass) {instrumentation_log('{"type":"FunctionExpression","bodyRange":[507,4232],"range":[486,4232],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":16,"label":"spine"}');
    var ENTER_KEY;

    extend(TodoApp, superClass);

    ENTER_KEY = 13;

    TodoApp.prototype.elements = {
      '#new-todo': 'newTodoInput',
      '#toggle-all': 'toggleAllElem',
      '#main': 'main',
      '#todo-list': 'todos',
      '#footer': 'footer',
      '#todo-count': 'count',
      '#filters a': 'filters',
      '#clear-completed': 'clearCompleted'
    };

    TodoApp.prototype.events = {
      'keyup #new-todo': 'new',
      'click #toggle-all': 'toggleAll',
      'click #clear-completed': 'clearCompletedItem'
    };

    function TodoApp() {instrumentation_log('{"type":"FunctionDeclaration","bodyRange":[1072,1936],"range":[1053,1936],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":5,"label":"spine"}');
      this.renderFooter = bind(this.renderFooter, this);
      this.toggleElems = bind(this.toggleElems, this);
      this.addAll = bind(this.addAll, this);
      this.addNew = bind(this.addNew, this);
      TodoApp.__super__.constructor.apply(this, arguments);
      Todo.bind('create', this.addNew);
      Todo.bind('refresh change', this.addAll);
      Todo.bind('refresh change', this.toggleElems);
      Todo.bind('refresh change', this.renderFooter);
      Todo.fetch();
      this.routes({
        '/:filter': function(param) {instrumentation_log('{"type":"FunctionExpression","bodyRange":[1607,1920],"range":[1591,1920],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":4,"label":"spine"}');
          this.filter = param.filter;

          /*
          				TODO: Need to figure out why the route doesn't trigger `change` event
           */
          Todo.trigger('refresh');
          return this.filters.removeClass('selected').filter("[href='#/" + this.filter + "']").addClass('selected');
        }
      });
    }

    TodoApp.prototype["new"] = function(e) {instrumentation_log('{"type":"FunctionExpression","bodyRange":[1981,2195],"range":[1969,2195],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":6,"label":"spine"}');
      var val;
      val = $.trim(this.newTodoInput.val());
      if (e.which === ENTER_KEY && val) {
        Todo.create({
          title: val
        });
        return this.newTodoInput.val('');
      }
    };

    TodoApp.prototype.getByFilter = function() {instrumentation_log('{"type":"FunctionExpression","bodyRange":[2245,2451],"range":[2234,2451],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":7,"label":"spine"}');
      switch (this.filter) {
        case 'active':
          return Todo.active();
        case 'completed':
          return Todo.completed();
        default:
          return Todo.all();
      }
    };

    TodoApp.prototype.addNew = function(todo) {instrumentation_log('{"type":"FunctionExpression","bodyRange":[2500,2627],"range":[2485,2627],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":8,"label":"spine"}');
      var view;
      view = new Todos({
        todo: todo
      });
      return this.todos.append(view.render().el);
    };

    TodoApp.prototype.addAll = function() {instrumentation_log('{"type":"FunctionExpression","bodyRange":[2672,2941],"range":[2661,2941],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":9,"label":"spine"}');
      var i, len, ref, results, todo;
      this.todos.empty();
      ref = this.getByFilter();
      results = [];
      for (i = 0, len = ref.length; i < len; i++) {
        todo = ref[i];
        results.push(this.addNew(todo));
      }
      return results;
    };

    TodoApp.prototype.toggleAll = function(e) {instrumentation_log('{"type":"FunctionExpression","bodyRange":[2990,3339],"range":[2978,3339],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":11,"label":"spine"}');
      var checked;
      checked = e.target.checked;
      return Todo.each(function(todo) {instrumentation_log('{"type":"FunctionExpression","bodyRange":[3083,3331],"range":[3068,3331],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":10,"label":"spine"}');

        /*
        			TODO: Model updateAttribute sometimes won't stick:
        				https://github.com/maccman/spine/issues/219
         */
        todo.updateAttribute('completed', checked);
        return todo.trigger('update', todo);
      });
    };

    TodoApp.prototype.clearCompletedItem = function() {instrumentation_log('{"type":"FunctionExpression","bodyRange":[3396,3441],"range":[3385,3441],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":12,"label":"spine"}');
      return Todo.destroyCompleted();
    };

    TodoApp.prototype.toggleElems = function() {instrumentation_log('{"type":"FunctionExpression","bodyRange":[3491,3794],"range":[3480,3794],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":13,"label":"spine"}');
      var completed, total;
      completed = Todo.completed().length;
      total = Todo.count();
      this.main.toggle(total !== 0);
      this.footer.toggle(total !== 0);
      this.toggleAllElem.prop('checked', completed === total);
      return this.clearCompleted.toggle(completed !== 0);
    };

    TodoApp.prototype.renderFooter = function() {instrumentation_log('{"type":"FunctionExpression","bodyRange":[3845,4205],"range":[3834,4205],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":15,"label":"spine"}');
      var active, completed, text;
      text = function(count) {instrumentation_log('{"type":"FunctionExpression","bodyRange":[3911,4025],"range":[3895,4025],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":14,"label":"spine"}');
        if (count === 1) {
          return 'item';
        } else {
          return 'items';
        }
      };
      active = Todo.active().length;
      completed = Todo.completed().length;
      return this.count.html("<strong>" + active + "</strong> " + (text(active)) + " left");
    };

    return TodoApp;

  })(Spine.Controller);

  $(function() {instrumentation_log('{"type":"FunctionExpression","bodyRange":[4269,4356],"range":[4258,4356],"file":"todomvc/examples.lacunized.instrumented/spine/js/app.js","index":17,"label":"spine"}');
    new TodoApp({
      el: $('#todoapp')
    });
    return Spine.Route.setup();
  });

}).call(this);
